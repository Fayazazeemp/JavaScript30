{"version":3,"sources":["src/index.js"],"names":["video","document","querySelector","canvas","ctx","getContext","strip","snap","getVideo","navigator","mediaDevices","getUserMedia","audio","then","localMediaStream","console","log","srcObject","play","catch","err","error","paintToCanvas","width","videoWidth","height","videoHeight","style","cssText","setInterval","drawImage","pixels","getImageData","rgbSplit","globalAlpha","putImageData","greenScreen","levels","querySelectorAll","forEach","input","name","value","i","data","length","red","green","blue","alpha","rmin","gmin","bmin","rmax","gmax","bmax","takePhoto","currentTime","toDataURL","link","createElement","href","setAttribute","innerHTML","insertBefore","firstChild","redEffect","addEventListener"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["const video = document.querySelector(\".player\");\r\nconst canvas = document.querySelector(\".photo\");\r\nconst ctx = canvas.getContext(\"2d\");\r\nconst strip = document.querySelector(\".strip\");\r\nconst snap = document.querySelector(\".snap\");\r\n\r\nfunction getVideo() {\r\n  navigator.mediaDevices\r\n    .getUserMedia({ video: true, audio: false })\r\n    .then(localMediaStream => {\r\n      console.log(localMediaStream);\r\n      video.srcObject = localMediaStream;\r\n      video.play();\r\n    })\r\n    .catch(err => {\r\n      console.error(\"Oh, NOOO!!!\", err);\r\n    });\r\n}\r\n\r\nfunction paintToCanvas() {\r\n  const width = video.videoWidth;\r\n  const height = video.videoHeight;\r\n  video.style.cssText =\r\n    '-moz-transform: scale(-1, 1); \\\r\n-webkit-transform: scale(-1, 1); -o-transform: scale(-1, 1); \\\r\ntransform: scale(-1, 1); filter: FlipH;';\r\n  canvas.width = width;\r\n  canvas.height = height;\r\n\r\n  return setInterval(() => {\r\n    ctx.drawImage(video, 0, 0, width, height);\r\n    //   take pixels out\r\n    let pixels = ctx.getImageData(0, 0, width, height);\r\n    // mess with them\r\n    // pixels = redEffect(pixels);\r\n\r\n    pixels = rgbSplit(pixels);\r\n    ctx.globalAlpha = 0.8;\r\n\r\n    // put them back\r\n    ctx.putImageData(pixels, 0, 0);\r\n    // debugger;\r\n  }, 16);\r\n}\r\n\r\nfunction greenScreen(pixels) {\r\n  const levels = {};\r\n\r\n  document.querySelectorAll(\".rgb input\").forEach(input => {\r\n    levels[input.name] = input.value;\r\n  });\r\n\r\n  for (i = 0; i < pixels.data.length; i = i + 4) {\r\n    red = pixels.data[i + 0];\r\n    green = pixels.data[i + 1];\r\n    blue = pixels.data[i + 2];\r\n    alpha = pixels.data[i + 3];\r\n\r\n    if (\r\n      red >= levels.rmin &&\r\n      green >= levels.gmin &&\r\n      blue >= levels.bmin &&\r\n      red <= levels.rmax &&\r\n      green <= levels.gmax &&\r\n      blue <= levels.bmax\r\n    ) {\r\n      // take it out!\r\n      pixels.data[i + 3] = 0;\r\n    }\r\n  }\r\n\r\n  return pixels;\r\n}\r\n\r\nfunction takePhoto() {\r\n  // play sound\r\n  snap.currentTime = 0;\r\n  snap.play();\r\n\r\n  const data = canvas.toDataURL(\"image/jpeg\");\r\n  const link = document.createElement(\"a\");\r\n  link.href = data;\r\n  link.setAttribute(\"download\", \"handsome\");\r\n  link.innerHTML = `<img src=\"${data}\" alt='Smart Man' />`;\r\n  strip.insertBefore(link, strip.firstChild);\r\n}\r\n\r\nfunction redEffect(pixels) {\r\n  for (let i = 0; i < pixels.data.length; i += 4) {\r\n    pixels.data[i + 0] += 100; //r\r\n    pixels.data[i + 1] -= 50; //g\r\n    pixels.data[i + 2] *= 0.5; //b\r\n  }\r\n  return pixels;\r\n}\r\n\r\nfunction rgbSplit(pixels) {\r\n  for (let i = 0; i < pixels.data.length; i += 4) {\r\n    pixels.data[i - 150] = pixels.data[i + 0]; // RED\r\n    pixels.data[i + 500] = pixels.data[i + 1]; // GREEN\r\n    pixels.data[i - 550] = pixels.data[i + 2]; // Blue\r\n  }\r\n  return pixels;\r\n}\r\n\r\ngetVideo();\r\n\r\nvideo.addEventListener(\"canplay\", paintToCanvas);\r\n"]}